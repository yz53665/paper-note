---
Title: "It is not the Journey but the Destination: Endpoint Conditioned Trajectory Prediction"
Year: "2020"
Publisher: ECCV
tags:
  - CVAE
  - goal
Datasets:
  - ETH-UCY
  - SDD
---
### 轨迹预测的难点和必要性
行人会主动施加因果力来改变自己的运动，并在这个过程中根据观察不断调整自己的路径来使得自己抵达目标。
由于该过程是在行人内心完成的，这使得通过外部观察来实现轨迹预测变得更加困难，所以需要考虑更多的因素来帮助预测，如：
+ 隐预预测目标
+ 场景中其它移动个体
+ 社会行为模式

### 轨迹预测前人研究问题


### 提出解决思路
对预测中的随机目标进行建模
本文提出三条假设：
+ 假设行人知道自己有些的期望目标
+ 行人会在考虑各种因素的情况下设法达到其中一各目标
+ 在达成目标的过程中会根据社会规范来不断调整自己的轨迹

基于此，本文将其划分为两个子任务：
+ 获取估计行人目标的可能分布，然后从中采集合适的目标点
+ 对这些目标点分别预测其轨迹
### 模型
![[Pasted image 20230927201632.png](../img/Pasted%20image%2020230927201632.png)

#### 终点(EndPoint)VAE
图中的红色是训练阶段路线，黑色是训练和推理阶段的路线。

#### 终点条件下的轨迹预测
本文使用训练中生成的终点来参与训练结果，从理论上分析使用真实的结果来训练未来轨迹可以更少引入噪音，获得更加干净的结果。然而根据实际经验来看，将两者拆分会导致训练结果更差。个人推测是影响了预测模型对预测终点的修正能力，终点不是预测的最终结果，而是需要考虑后续最终轨迹的中间产物。

#### 最终损失函数
$$
\mathcal{L}_{PECNet} = \lambda_1 D_{KL}(\mathcal{N}(\mathbb{\mu}, \mathbb{\sigma}) \parallel  \mathcal{N}(0, I) ) + \lambda_2 \parallel \hat{\mathcal{G}}_c - \mathcal{G}_c \parallel_2^2 + \parallel \hat{\mathcal{T}}_f - \mathcal{T}_f \parallel ^2
$$
由三部分组成：
+ KL散度让输出分布拟合于标准正态分布
+ 终点损失
+ 整体轨迹损失
### 实验验证
+ ETH-UCY
+ SDD
#### 目标点的作用
![[Pasted image 20230927220711.png](../img/Pasted%20image%2020230927220711.png)
结论：
1. 预测的最终目标放的越远，整体error越小，说明越远的点带来的信息越多
2. 在7帧之前两者之间的差异很小，这说明此时并不包含有帮助的实质性信息
3. 每帧的误差如绿线所示，本来应该越来越高的误差反而在中间之后保持了稳定（error plateaus），说明了最终目标点比中间点更加重要。
#### 采样数量（K）的作用
![[Pasted image 20230927221611.png](../img/Pasted%20image%2020230927221611.png)
本文在采样10次就达到了前人生成20条轨迹的效果，这说明基于推理关键点的轨迹生成方式极大简化了建模的复杂度，提供了对真实轨迹更好的估计。
而随着采样数量越来越大，FDE低于ADE，这是由于最终采样到了真实点；而ADE则上文采样真实点预测轨迹的结果相似，这也侧面说明了其最终达到了真实点
#### 使用真实点来训练轨迹预测网络
本文实验发现结果会差8%左右。
### 总结与讨论

本文提出了一种通用的模型训练范式，但受限于时代特点，本文仍然在使用social pooling，其会导致over-smoothing问题，影响行人轨迹多样性的表达。
最最最经典的轨迹预测CVAE表达。比起[[2023-09-26.md]]表达更加规范，模型更加有效，将CVAE发扬光大。