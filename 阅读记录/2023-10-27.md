---
Title: A Set of Control Points Conditioned Pedestrian Trajectory Prediction
Year: "2023"
Publisher: AAAI
tags:
  - waypoints
  - goal
  - refine
  - GMM
  - GCN
Datasets:
  - ETH-UCY
  - SDD
输入:
  - position
输出:
  - position
  - disaplacement
多模态:
  - distribution
概率建模:
  - GMM
基于终点: true
关系提取:
  - GCN
关系衡量:
  - relative position
  - disaplacement
解决问题:
  - 累积误差
  - 未来关系
---

# 轨迹预测前人研究问题
1. 递归预测每一步，都存在累积误差；
2. 一次性预测所有轨迹，长距离效果差，同时限制了路途上行人关系的考量

# 提出解决思路
将整个轨迹划分为3阶段，分别预测每一段的轨迹
然后提出一个refine微调阶段，根据周围环境情况微调整体轨迹

# 文章贡献


# 模型
+ 学习终点分布和终点采样
+ 轨迹调优
![[Pasted image 20231028120430.png](../img/Pasted%20image%2020231028120430.png)

#####  关键点分布预测
均等划分关键点
![[Pasted image 20231028142445.png](../img/Pasted%20image%2020231028142445.png)
学习GMM的分布，但GMM无法对稀有点建模，且会反过来被影响导致var变大影响其它预测，文章提出了一种GMM剪枝法：
![[Pasted image 20231028143634.png](../img/Pasted%20image%2020231028143634.png)
##### 关键点采样
在每个关键点处考虑周围影响后给出采样区域，如上一小节图(b)所示

##### 关系建模
文章在GCN和GAT中选择使用GAT，并给出了有说服力的理由。
在构建关系时，衡量关系的方法不光使用相对距离，还使用了**距离、位移**，以及它们的相反数。当只使用一种时很多时候会忽略身后的同伴。
##### 指导下的终点采样
由于预测的终点并不总是靠近真实值，所以在训练阶段加入了一定限制。即只对和真实值距离小于一定范围的点进行反向传播，其它点会被忽略。

##### 初始轨迹生成和轨迹调优
使用插值生成中间轨迹，然后获取学习得到的中间调优轨迹。
使用初步轨迹来构建社会关系，而不是真实轨迹。
其中第二个模型输出的是插值轨迹和实际轨迹的偏差量

# 实验验证

# 总结与讨论

##### 想法
循环预测会累积误差，中间难以调整，并且限制了视野；
整体预测无法考虑未来轨迹与周围环境的影响。

如何将这种微调思路用于其它方面？

概率模型无法对稀有的异常轨迹建模，并且会使得学习得到的模型var变大，本文参考前人使用剪枝来避免这一问题

##### 存在不足
+ 不同行人之间相互影响耦合
+ 社会关系无法考虑可行区域

